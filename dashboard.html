<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†Ø¬Ù… Ø§Ù„Ø°Ù‡Ø¨</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="container">
        <h3>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ù†Ø¬Ù… â›ï¸</h3>
        
        <div class="mining-stat">
            Ø§Ù„Ø±ØµÙŠØ¯: <span id="balance">0.0000</span> $
        </div>
        
        <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExM3ZxeWwzb3ZxeWwzb3ZxeWwzb3ZxeWwzb3ZxeWwzb3ZxeWwzb3ZxeWwzbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9cw/LdOyjZ7FKs0RlAzU8a/giphy.gif" width="100">
        
        <p>Ù‚ÙˆØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†: <span id="power">...</span> / Ø«Ø§Ù†ÙŠØ©</p>
        <button onclick="collect()" style="background:green; color:white;">Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ğŸ’°</button>
        <button onclick="logout()" style="background:red; margin-top:20px;">Ø®Ø±ÙˆØ¬</button>
    </div>

    <script src="auth.js"></script>
    <script>
        // ÙƒÙˆØ¯ Ø®Ø§Øµ Ø¨Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ÙÙ‚Ø·
        let user_id;
        
        // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
        window.onload = async function() {
            const user = await checkSession();
            user_id = user.id;
            loadData();
        };

        async function loadData() {
            const { data } = await supabase.from('profiles').select('*').eq('id', user_id).single();
            if(data) {
                document.getElementById('balance').innerText = data.balance.toFixed(4);
                document.getElementById('power').innerText = data.mining_power;
            }
        }
        
        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ù…Ø¹ (Ù…Ø®ØªØµØ±Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
        async function collect() {
            alert("Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø© Ø§Ù„Ø¬Ù…Ø¹ Ù‡Ù†Ø§ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¯Ù…!");
            // ÙŠÙ…ÙƒÙ†Ùƒ Ù†Ø³Ø® Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ù…Ø¹ Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù‡Ù†Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
        }
    </script>
</body>
</html>
